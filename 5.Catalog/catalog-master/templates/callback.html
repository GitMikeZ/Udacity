<html>

<head>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='bootstrap.min.css')}}">
  <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='style.css')}}">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <script src="{{url_for('static',filename='jquery.min.js')}}"></script>
  <script src="{{url_for('static',filename='bootstrap.min.js')}}"></script>


  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">
  </script>

  <script src="//apis.google.com/js/platform.js?onload=start">
  </script>

</head>

<body>
  <div class='navbar navbar-inverse navbar-static-top'>
    <div class='container'>
      <a href='/' class='navbar-brand'>Catalog App</a>

      <ul class='nav navbar-nav navbar-right'>

        <li><a href='/login'>Login </a>


        </li>
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-6 col-md-offset-3 text-center">


        <div id="result"></div>

      </div>


    </div>


  </div>


  <script type="text/javascript">
    $(document).ready(
  
          function sendCodeToServer() {
          console.log('sendCode executed')
        params = window.location['search']
      
        code = params.split('=')[1]
        code = code.split('&')[0]
      
        state = params.split('&')[1]
        state = state.split('=')[1]
     
        
        $.ajax({
          type: 'POST',
            url: '/gitconnect?state={{STATE}}',
            processData: false,
            data: code,
            contentType: 'application/octet-stream; charset=utf-8',
            success: function(result) {
            // Handle or verify the server response if necessary.
              
  
              if (result) {
                console.log('1')
            $('#result').html('Login Successful!</br>'+ result + '</br>')
           setTimeout(function() {
            window.location.href = "/catalog/";
           }, 4000);
            
        } else {
          console.log('2')
          $('#result').html('Failed to make a server-side call. Check your configuration and console.');
           }
            }
        
        });
      
      }
  
          
        )
  </script>


</body>

</html>